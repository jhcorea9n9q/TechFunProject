<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
        "-//mybatis.org//DTD Mapper 3.0//EN" 
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.techfun.persistence.UserMapper">
	<select id="emailHasSame" resultType="Integer">
		SELECT COUNT(*) FROM sns_user WHERE email = #{email}
	</select>
	<insert id="userInsert">
		INSERT INTO sns_user(email, password, inp_date)
		VALUES (#{email}, #{password}, NOW());
	</insert>
	<select id="accountCheck" resultType="com.techfun.domain.SNSUser">
		SELECT * FROM sns_user
		<where>
				email = #{email} AND password = #{password}
		</where>
	</select>
	<select id="accountCheckbyNick" resultType="com.techfun.domain.SNSUser">
		SELECT sns_user.* FROM sns_user
		INNER JOIN profile ON sns_user.id = profile.user_id
		<where>
				profile.nicknm = #{email} AND password = #{password}
		</where>
	</select>
	<select id="getProfileData" resultType="com.techfun.domain.Profile">
		SELECT profile.* FROM sns_user
		INNER JOIN profile ON sns_user.id = profile.user_id
		<where>
				sns_user.id = #{id}
		</where>
	</select>
	<insert id="insertProfile">
		INSERT INTO profile(user_id, nicknm, prof_pic_url, gender, gender_prvt, birth, birth_prvt, hobby, hobby_prvt, prgrm_lang, intrdc, intrdc_prvt, inp_date)
		VALUES (#{userId}, #{nicknm}, #{profPicUrl}, #{gender}, #{genderPrvt}, #{birth}, #{birthPrvt}, #{hobby}, #{hobbyPrvt}, #{prgrmLang}, #{intrdc}, #{intrdcPrvt}, NOW());
	</insert>
	<update id="profileComplete">
		UPDATE sns_user SET prof_yn = 'Y' WHERE id = #{id};
	</update>
</mapper>